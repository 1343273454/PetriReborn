"item_petri_pill"
{
  "BaseClass"               "item_datadriven"
  "ID"                      "3456"
  "AbilityBehavior"         "DOTA_ABILITY_BEHAVIOR_NO_TARGET | DOTA_ABILITY_BEHAVIOR_IMMEDIATE"
  "Model"                   "models/props_gameplay/red_box.vmdl" 
  "Effect"                  "particles/generic_gameplay/dropped_item.vpcf"
  "AbilityTextureName"      "item_petri_pill"

  "AbilityCastPoint"      "0"
  "AbilityCooldown"       "0"
  "AbilityManaCost"       "0"
  
  "ItemShareability"      "ITEM_FULLY_SHAREABLE"
  "ItemShopTags"        "consumable"
  "ItemQuality"         "consumable"
  "ItemPermanent"         "0"
  "ItemSellable"          "0"
  "ItemKillable"          "1"
  "ItemPurchasable"       "0"

  "ItemStackable" "0"
  "ItemPermanent" "0"
  "ItemInitialCharges" "1"
  "ItemDisplayCharges" "1"
  "ItemRequiresCharges" "1"
  "ItemDisassembleRule" "DOTA_ITEM_DISASSEMBLE_NEVER"

  "AbilitySpecial"
  {
    "01"
    {
      "var_type"          "FIELD_FLOAT"
      "damage"              "102.5"
    }
    "02"
    {
      "var_type"          "FIELD_FLOAT"
      "chance"              "40"
    }
  }

  "OnSpellStart"
  {    
    "SpendCharge" 
    {}
    "ApplyModifier"
    {
      "ModifierName"  "modifier_crits"
      "Target"     "CASTER"
    }
  }

  "Modifiers"
  {
    "modifier_crits"
    {
      "Passive"      "0"
      "IsHidden"      "0"
      "IsDebuff"      "0"

      "Attributes"    "MODIFIER_ATTRIBUTE_PERMANENT"

      "RemoveOnDeath"       "0"
  
      "OnAttackStart"
      {
          "RemoveModifier"
          {
              "ModifierName"  "modifier_crits_crit"
              "Target"        "CASTER"
          }

          "Random"
          {
            "Chance"        "%chance"
            "PseudoRandom"  "DOTA_PSEUDO_RANDOM_PHANTOMASSASSIN_CRIT"

            "OnSuccess"
            {
              "ApplyModifier"
              {
                "ModifierName"  "modifier_crits_crit"
                "Target"        "CASTER"
              }
            }
          }
      }
    }

    "modifier_crits_crit"
    {
      "IsHidden"  "1"

      "Properties"
      {
          "MODIFIER_PROPERTY_PREATTACK_CRITICALSTRIKE" "%damage"
      }

      "OnAttackLanded"
      {
        "RemoveModifier"
        {
          "ModifierName"  "modifier_crits_crit"
          "Target"        "CASTER"
        }

        "FireEffect"
        {
          "EffectName"    "particles/units/heroes/hero_phantom_assassin/phantom_assassin_crit_impact.vpcf"
          "EffectAttachType"  "start_at_customorigin"
          
          "ControlPointEntities"
          {
            "TARGET"    "follow_origin"
            "TARGET"    "follow_origin"
          }
        }

        "FireSound"
        {
          "EffectName"    "Hero_PhantomAssassin.CoupDeGrace"
          "Target"        "TARGET"
        }
      }
    }
  }
}